

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Solvers &mdash; George 1.0.0.dev0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="George 1.0.0.dev0 documentation" href="../../"/>
        <link rel="next" title="Modeling protocol" href="../modeling/"/>
        <link rel="prev" title="The GP object" href="../gp/"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../../" class="icon icon-home"> George
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart/">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/#installation">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../quickstart/#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quickstart/#stable-version">Stable Version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quickstart/#development-version">Development Version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quickstart/#testing">Testing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../upgrade/">Upgrading from pre-1.0 versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernels/">Kernels</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../kernels/#common-parameters">Common parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernels/#implementation-details-modeling-interface">Implementation details &amp; modeling interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernels/#stationary-kernels">Stationary kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernels/#non-stationary-kernels">Non-stationary kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernels/#combining-kernels">Combining kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kernels/#implementing-new-kernels">Implementing new kernels</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gp/">The GP object</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Solvers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basic-solver">Basic Solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hodlr-solver">HODLR Solver</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modeling/">Modeling protocol</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../modeling/#the-protocol">The protocol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modeling/#a-simple-example">A simple example</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/first/">A gentle introduction to Gaussian Process Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/model/">Model fitting with correlated noise</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/model/#a-simple-mean-model">A Simple Mean Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/model/#simulated-dataset">Simulated Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/model/#assuming-white-noise">Assuming White Noise</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/model/#modeling-the-noise">Modeling the Noise</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/model/#the-final-fit">The Final Fit</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/hyper/">Hyperparameter optimization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/hyper/#optimization">Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/hyper/#sampling-marginalization">Sampling &amp; Marginalization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/scaling/">Scaling Gaussian Processes to big datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/new_kernel/">Implementing new kernels</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/new_kernel/#the-kernel-function">The kernel function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/new_kernel/#kernel-specification">Kernel specification</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../">George</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../">Docs</a> &raquo;</li>
      
    <li>Solvers</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="https://github.com/dfm/george/blob/master/docs/user/solvers" class="fa fa-github"> Edit on GitHub</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <span class="target" id="module-george"></span><div class="section" id="solvers">
<span id="id1"></span><h1>Solvers<a class="headerlink" href="#solvers" title="Permalink to this headline">Â¶</a></h1>
<p>There are currently two different GP solvers included with George using
different libraries for doing linear algebra.
Both of the solvers implement the same API and should (up to some tolerance)
give the same answers on the same datasets.
A solver is just a class that takes a <code class="xref py py-class docutils literal"><span class="pre">Kernel</span></code> and that exposes 3
methods:</p>
<ol class="arabic simple">
<li><code class="docutils literal"><span class="pre">compute</span></code> &#8212; to compute and factorize the kernel matrix,</li>
<li><code class="docutils literal"><span class="pre">apply_inverse</span></code> &#8212; to left-multiply the input by the covariance matrix
<span class="math">\(C^{-1}\,b\)</span> (actually implemented by solving the system
<span class="math">\(C\,x = b\)</span>), and</li>
<li><code class="docutils literal"><span class="pre">apply_sqrt</span></code> &#8212; to apply the (Cholesky) square root of the covariance.</li>
</ol>
<p>The solvers also provide the properties <code class="docutils literal"><span class="pre">computed</span></code> and <code class="docutils literal"><span class="pre">log_determinant</span></code>.</p>
<p>The simplest solver provided by George (<a class="reference internal" href="#george.BasicSolver" title="george.BasicSolver"><code class="xref py py-class docutils literal"><span class="pre">BasicSolver</span></code></a>) uses <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.cholesky.html">scipy&#8217;s
Cholesky implementation</a>
and the second implementation (<a class="reference internal" href="#george.HODLRSolver" title="george.HODLRSolver"><code class="xref py py-class docutils literal"><span class="pre">HODLRSolver</span></code></a>) uses  Sivaram
Amambikasaran&#8217;s <a class="reference external" href="https://github.com/sivaramambikasaran/HODLR">HODLR library</a>.
The HODLR algorithm implements a <span class="math">\(\mathcal{O}(N\,\log^2 N)\)</span> direct
solver for dense matrices as described <a class="reference external" href="http://arxiv.org/abs/1403.6015">here</a>.</p>
<p>By default, George uses the <a class="reference internal" href="#george.BasicSolver" title="george.BasicSolver"><code class="xref py py-class docutils literal"><span class="pre">BasicSolver</span></code></a> but the <a class="reference internal" href="#george.HODLRSolver" title="george.HODLRSolver"><code class="xref py py-class docutils literal"><span class="pre">HODLRSolver</span></code></a>
can be used as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">george</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">gp</span> <span class="o">=</span> <span class="n">george</span><span class="o">.</span><span class="n">GP</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">george</span><span class="o">.</span><span class="n">HODLRSolver</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="#george.HODLRSolver" title="george.HODLRSolver"><code class="xref py py-class docutils literal"><span class="pre">HODLRSolver</span></code></a> is probably best for most one-dimensional problems
and some large multi-dimensional problems but it doesn&#8217;t (in general) scale
well with the number of input dimensions.
In practice, it&#8217;s worth trying both solvers on your specific problem to see
which runs faster.</p>
<div class="section" id="basic-solver">
<h2>Basic Solver<a class="headerlink" href="#basic-solver" title="Permalink to this headline">Â¶</a></h2>
<dl class="class">
<dt id="george.BasicSolver">
<em class="property">class </em><code class="descclassname">george.</code><code class="descname">BasicSolver</code><span class="sig-paren">(</span><em>kernel</em><span class="sig-paren">)</span><a class="headerlink" href="#george.BasicSolver" title="Permalink to this definition">Â¶</a></dt>
<dd><p>This is the most basic solver built using <code class="xref py py-func docutils literal"><span class="pre">scipy.linalg.cholesky()</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>kernel</strong> &#8211; A subclass of <code class="xref py py-class docutils literal"><span class="pre">Kernel</span></code> implementing a kernel function.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="george.BasicSolver.apply_inverse">
<code class="descname">apply_inverse</code><span class="sig-paren">(</span><em>y</em>, <em>in_place=False</em><span class="sig-paren">)</span><a class="headerlink" href="#george.BasicSolver.apply_inverse" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Apply the inverse of the covariance matrix to the input by solving</p>
<div class="math">
\[C\,x = b\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>y</strong> &#8211; <code class="docutils literal"><span class="pre">(nsamples,)</span></code> or <code class="docutils literal"><span class="pre">(nsamples,</span> <span class="pre">nrhs)</span></code>
The vector or matrix <span class="math">\(b\)</span>.</li>
<li><strong>in_place</strong> &#8211; (optional)
Should the data in <code class="docutils literal"><span class="pre">y</span></code> be overwritten with the result <span class="math">\(x\)</span>?</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="george.BasicSolver.apply_sqrt">
<code class="descname">apply_sqrt</code><span class="sig-paren">(</span><em>r</em><span class="sig-paren">)</span><a class="headerlink" href="#george.BasicSolver.apply_sqrt" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Apply the Cholesky square root of the covariance matrix to the input
vector or matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>r</strong> &#8211; <code class="docutils literal"><span class="pre">(nsamples,)</span></code> or <code class="docutils literal"><span class="pre">(nsamples,</span> <span class="pre">nrhs)</span></code>
The input vector or matrix.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="george.BasicSolver.compute">
<code class="descname">compute</code><span class="sig-paren">(</span><em>x</em>, <em>yerr</em><span class="sig-paren">)</span><a class="headerlink" href="#george.BasicSolver.compute" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute and factorize the covariance matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> &#8211; <code class="docutils literal"><span class="pre">(nsamples,</span> <span class="pre">ndim)</span></code>
The independent coordinates of the data points.</li>
<li><strong>yerr</strong> &#8211; (optional) <code class="docutils literal"><span class="pre">(nsamples,)</span></code> or scalar
The Gaussian uncertainties on the data points at coordinates
<code class="docutils literal"><span class="pre">x</span></code>. These values will be added in quadrature to the diagonal of
the covariance matrix.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="george.BasicSolver.computed">
<code class="descname">computed</code><a class="headerlink" href="#george.BasicSolver.computed" title="Permalink to this definition">Â¶</a></dt>
<dd><p>A flag indicating whether or not the covariance matrix was computed
and factorized (using the <a class="reference internal" href="#george.BasicSolver.compute" title="george.BasicSolver.compute"><code class="xref py py-func docutils literal"><span class="pre">compute()</span></code></a> method).</p>
</dd></dl>

<dl class="attribute">
<dt id="george.BasicSolver.log_determinant">
<code class="descname">log_determinant</code><a class="headerlink" href="#george.BasicSolver.log_determinant" title="Permalink to this definition">Â¶</a></dt>
<dd><p>The log-determinant of the covariance matrix. This will only be
non-<code class="docutils literal"><span class="pre">None</span></code> after calling the <a class="reference internal" href="#george.BasicSolver.compute" title="george.BasicSolver.compute"><code class="xref py py-func docutils literal"><span class="pre">compute()</span></code></a> method.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="hodlr-solver">
<h2>HODLR Solver<a class="headerlink" href="#hodlr-solver" title="Permalink to this headline">Â¶</a></h2>
<dl class="class">
<dt id="george.HODLRSolver">
<em class="property">class </em><code class="descclassname">george.</code><code class="descname">HODLRSolver</code><a class="headerlink" href="#george.HODLRSolver" title="Permalink to this definition">Â¶</a></dt>
<dd><p>A solver using Sivaram Amambikasaran&#8217;s <a class="reference external" href="https://github.com/sivaramambikasaran/HODLR">HODLR library</a> that implements a
<span class="math">\(\mathcal{O}(N\,\log^2 N)\)</span> direct solver for dense matrices as
described <a class="reference external" href="http://arxiv.org/abs/1403.6015">here</a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>kernel</strong> &#8211; A subclass of <code class="xref py py-class docutils literal"><span class="pre">Kernel</span></code> implementing a kernel function.</li>
<li><strong>nleaf</strong> &#8211; (optional)
The size of the smallest matrix blocks. When the solver reaches this
level in the tree, it directly solves these systems using Eigen&#8217;s
Cholesky implementation. (default: <code class="docutils literal"><span class="pre">100</span></code>)</li>
<li><strong>tol</strong> &#8211; (optional)
A tuning parameter used when factorizing the matrix. The conversion
between this parameter and the precision of the results is problem
specific but if you need more precision, try deceasing this number
(at the cost of a longer runtime). (default: <code class="docutils literal"><span class="pre">1e-12</span></code>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="george.HODLRSolver.apply_inverse">
<code class="descname">apply_inverse</code><span class="sig-paren">(</span><em>y</em>, <em>in_place=False</em><span class="sig-paren">)</span><a class="headerlink" href="#george.HODLRSolver.apply_inverse" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Apply the inverse of the covariance matrix to the input by solving</p>
<div class="math">
\[C\,x = b\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>y</strong> &#8211; <code class="docutils literal"><span class="pre">(nsamples,)</span></code> or <code class="docutils literal"><span class="pre">(nsamples,</span> <span class="pre">nrhs)</span></code>
The vector or matrix <span class="math">\(b\)</span>.</li>
<li><strong>in_place</strong> &#8211; (optional)
Should the data in <code class="docutils literal"><span class="pre">y</span></code> be overwritten with the result <span class="math">\(x\)</span>?</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="george.HODLRSolver.apply_sqrt">
<code class="descname">apply_sqrt</code><span class="sig-paren">(</span><em>r</em><span class="sig-paren">)</span><a class="headerlink" href="#george.HODLRSolver.apply_sqrt" title="Permalink to this definition">Â¶</a></dt>
<dd><p>This method is not implemented by this solver yet.</p>
</dd></dl>

<dl class="method">
<dt id="george.HODLRSolver.compute">
<code class="descname">compute</code><span class="sig-paren">(</span><em>x</em>, <em>yerr</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="headerlink" href="#george.HODLRSolver.compute" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute and factorize the covariance matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> &#8211; <code class="docutils literal"><span class="pre">(nsamples,</span> <span class="pre">ndim)</span></code>
The independent coordinates of the data points.</li>
<li><strong>yerr</strong> &#8211; (optional) <code class="docutils literal"><span class="pre">(nsamples,)</span></code> or scalar
The Gaussian uncertainties on the data points at coordinates
<code class="docutils literal"><span class="pre">x</span></code>. These values will be added in quadrature to the diagonal of
the covariance matrix.</li>
<li><strong>seed</strong> &#8211; (optional)
There is a stochastic component in the HODLR factorization step.
Use this parameter (it should be an integer) to seed this random
step and ensure deterministic results. Normally the randomization
shouldn&#8217;t make a big difference but as the matrix becomes poorly
conditioned, it will have a larger effect.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="george.HODLRSolver.computed">
<code class="descname">computed</code><a class="headerlink" href="#george.HODLRSolver.computed" title="Permalink to this definition">Â¶</a></dt>
<dd><p>A flag indicating whether or not the covariance matrix was computed
and factorized (using the <a class="reference internal" href="#george.HODLRSolver.compute" title="george.HODLRSolver.compute"><code class="xref py py-func docutils literal"><span class="pre">compute()</span></code></a> method).</p>
</dd></dl>

<dl class="attribute">
<dt id="george.HODLRSolver.log_determinant">
<code class="descname">log_determinant</code><a class="headerlink" href="#george.HODLRSolver.log_determinant" title="Permalink to this definition">Â¶</a></dt>
<dd><p>The log-determinant of the covariance matrix. This will only be
non-<code class="docutils literal"><span class="pre">None</span></code> after calling the <a class="reference internal" href="#george.HODLRSolver.compute" title="george.HODLRSolver.compute"><code class="xref py py-func docutils literal"><span class="pre">compute()</span></code></a> method.</p>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../modeling/" class="btn btn-neutral float-right" title="Modeling protocol" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../gp/" class="btn btn-neutral" title="The GP object" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013-2014 Dan Foreman-Mackey.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.0.dev0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="../../_static/js/analytics.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>