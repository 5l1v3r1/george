name: GRPPeriodicKernel
stationary: false
params: [ln_qfactor, ln_frequency]

doc: |
    The generalized Rybicki Press kernel

reparams:
    qfactor:
        return exp(-ln_qfactor);
    ffactor:
        return 2 * M_PI * exp(ln_frequency);

value: |
    double delta = fabs(x1 - x2);
    return exp(-qfactor * delta) * cos(delta * ffactor);

grad:
    ln_qfactor: |
        double delta = fabs(x1 - x2),
               k = exp(-qfactor * delta) * cos(delta * ffactor);
        return k * qfactor * delta;

    ln_frequency: |
        double delta = fabs(x1 - x2),
               r = delta * ffactor;
        return -exp(-qfactor * delta) * r * sin(r);
