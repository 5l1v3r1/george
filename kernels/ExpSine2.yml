name: ExpSine2Kernel
stationary: false
params: [gamma, ln_period]

doc: |
    The exp-sine-squared kernel is a commonly used periodic kernel. Unlike
    the :class:`CosineKernel`, this kernel never has negative covariance
    which might be useful for your problem. Here's the equation:

    .. math::
        k(\mathbf{x}_i,\,\mathbf{x}_j) =
            \exp \left( -\Gamma\,\sin^2\left[
                \frac{\pi}{P}\,\left|x_i-x_j\right|
            \right] \right)

    :param gamma:
        The scale :math:`\Gamma` of the correlations.

    :param ln_period:
        The logarithm of the period :math:`P` of the oscillation (in the same
        units as :math:`\mathbf{x}`).

value: |
    double s = sin((x1 - x2) * M_PI * exp(-ln_period));
    return exp(-gamma * s * s);

grad:
    gamma: |
        double s = sin(M_PI * (x1 - x2) * exp(-ln_period)), s2 = s * s;
        return -s2 * exp(-gamma * s2);
    ln_period: |
        double arg = M_PI * (x1 - x2) * exp(-ln_period),
               s = sin(arg), c = cos(arg),
               A = exp(-gamma * s * s);
        return 2 * gamma * arg * c * s * A;
